<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.hjx.blog_backstage.Mappers.NavMapper">
    <insert id="setNav" parameterType="Nav" useGeneratedKeys="true" keyProperty="nid"  keyColumn="nid">
        insert into nav(title, path, navDesc) values(#{title}, #{path}, #{navDesc})
    </insert>

    <select id="getNav" resultType="Nav">
        select distinct nid, title, path, navDesc, if(b.navNumBer is not null, 'true', 'false') as hasChildren from nav a left join
        (select navNumBer from childNav) b on a.nid = b.navNumBer order by a.nid
    </select>

    <insert id="setChildNav" parameterType="ChildNav" useGeneratedKeys="true" keyProperty="ncid"  keyColumn="ncid">
        insert into childNav(navNumber, title, path, navDesc) values(#{navNumber}, #{title}, #{path}, #{navDesc})
    </insert>

    <select id="getChildNav" parameterType="Integer" resultType="ChildNav">
        select ncid, navNumber, title, path, navDesc from childNav
        where navNumber=#{parentIndex}
    </select>

    <select id="getHomeNav" resultType="Nav">
        select nid, title, path
        from nav
    </select>

    <select id="getHomeNavChild" resultType="ChildNav" parameterType="Integer">
        select ncid, navNumber, childTitle, childPath
        from childNav
    </select>

    <delete id="deleteParentNav" parameterType="Integer">
        delete from nav where nid =#{id}
    </delete>

    <delete id="deleteChildNav" parameterType="Integer">
        delete from childNav
        <where>
            <if test="id != null">
                ncid = #{id}
            </if>
            <if test="parentId != null">
                navNumBer = #{parentId}
            </if>
        </where>
    </delete>

</mapper>